<a id="post-number-<%= post.post_number %>"></a>
<div id="post-<%= post.id %>">
  <% if (u = post.user) %>
    <div class='creator'>
        <span>
          <a href='<%= Discourse.base_uri %>/u/<%= u.username %>'><b itemprop='author'><%= u.username %></b></a>
          <%= "(#{u.name})" if (SiteSetting.display_name_on_posts && SiteSetting.enable_names? && !u.name.blank?) %>
          <% who_username = post.custom_fields["action_code_who"] || "" %>
          <% if post.action_code %>
            <%= t("js.action_codes.#{post.action_code}", when: "", who: who_username).html_safe %>
          <% end %>
          <time datetime='<%= post.created_at.to_formatted_s(:iso8601) %>' itemprop='datePublished'>
            <%= post.created_at %>
          </time>
        </span>
      <span itemprop='position'>#<%= post.post_number %></span>
    </div>
    <div class='post' itemprop='articleBody'>
      <% if post.hidden? %>
        <%= t('flagging.user_must_edit').html_safe %>
      <% else %>
        <%= markdown(post.raw) %>
      <% end %>
    </div>
    <hr>
  <% end %>
</div>

<script>
    loadAnnotator('#post-<%= post.id %> > .post', '/post/<%= post.id %>');
</script>